# token

`token` is a chat bot for acknowledging peers for helping you and for giving prizes to people who have helped others. It was built on the [Hubot][hubot] framework.

## Summary

The bot keeps track of acknowledgment or thanks given from one user to another. Each unit of acknowledgment is called a **token**. Users can send one token at a time to other users.

Users can also revoke a token. There are a couple reasons why someone may revoke a token. They may decide that the person was not helping as much as hoped. Or they may want to give that token to someone else who has been more helpful. 

Finally, users can ask the bot to show the status of a user, and they can ask for a leaderboard of who has received the most tokens. 

The administrator of the bot can "freeze" the giving and revoking of tokens using the environment variable `TOKENS_CAN_BE_TRANSFERRED`. More details are in the section "Technical information".

The bot was developed for a randomized controlled trial on social networks and entrepreneurship called [The Adansonia Project][adansonia]. At the end of the experiment, each token is a lottery ticket for a prize. Thus, the `token` bot creates incentives for people to help one another.

[hubot]: http://hubot.github.com
[adansonia]: https://adansonia.net/

## Usage 

### Giving and revoking tokens 

Did `@user` help you? Then `/give` a token to `@user` to thank them!
```
/give a token to @user
/give @user                    # equivalent to the previous command
```

Changed your mind? Or someone else has helped you even more and you've run out of tokens to give them? Then `/revoke` a token from `user`:
```
/revoke a token from @user
/revoke @user                  # equivalent to the above
```

(The `/` is an alias for the bot's name, `token`, so you can also write all these commands as `token give a token to @user`.)

### Status

Want to check how many tokens you have left in your "pocket", how many you've given out (and to whom), and how many you've received (and from whom)? Then use the `/status` command: 
```
/status
```

You can also use this command to check the status of any other user:
```
/status @user
```

### Who has tokens to give out?

Got time to spare and want to find people to help? Use the following command to see a list of all people who still tokens available to give to others:

```
/show user with tokens
/who has tokens?         # equivalent to the previous command
```

### Leaderboard 

Who has been given the most tokens? See who's on top with the `/leaderboard` command. Control how large the leaderboard is using the command `/show top 5 list` or `/show top eight`.


## Technical information 

### Generation 

This bot was initially generated by [generator-hubot][generator-hubot], and configured to be
deployed on [Heroku][heroku].

[heroku]: http://www.heroku.com
[generator-hubot]: https://github.com/github/generator-hubot

### Running token Locally

You can test your hubot by running the following, however some plugins will not
behave as expected unless the [environment variables](#configuration) they rely
upon have been set.

You can start token locally by running:

    % bin/hubot

You'll see some start up output and a prompt:

    token> [Mon Jul 18 2016 12:10:53 GMT-0500 (CDT)] INFO hubot-redis-brain: Using default redis on localhost:6379
    token>

Then you can interact with token by typing `token help`.

    token> token help
    token give a token to @user_name - Gives a token to `@user_name`. The words 'token', 'a' and 'to' are optional.
    token help - Displays all of the help commands that token knows about.
    ...

### Configuration

The following environment variables can optionally be set: 

`TOKEN_ALLOW_SELF` (if not set, the default is `false`)
`TOKENS_CAN_BE_TRANSFERRED` (if not set, the default is `true`)
`TOKENS_ENDOWED_TO_EACH_USER`  (if not set, the default is 5)

How to set environment variables will be specific to your operating system.
Rather than recreate the various methods and best practices in achieving this,
it's suggested that you search for a dedicated guide focused on your OS.

#### Configuration on Heroku 

If you're using [Heroku] to deploy the bot, set the environment variables using the following commands:

```
heroku config:set TOKEN_ALLOW_SELF=false
heroku config:set TOKENS_CAN_BE_TRANSFERRED=true
heroku config:set TOKENS_ENDOWED_TO_EACH_USER=5
heroku config:set HUBOT_HEROKU_KEEPALIVE_URL=<url-for-your-token-bot>
```
where `<url-for-your-token-bot>` is a URL such as `https://token-bot.herokuapp.com/`.
heroku config:set HUBOT_ALIAS=/

[heroku]: http://www.heroku.com

### Adapters

This bot currently uses the [Rocket.Chat Hubot adapter][rocketchat-hubot]. 

[rocketchat-hubot]: https://github.com/RocketChat/hubot-rocketchat
